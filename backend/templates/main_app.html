<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <title>Enscribe</title>
    <link href="/static/main_app.css" rel="stylesheet"/>
  </head>
  <body>
    <header class="spaced-bar tool-bar">
      <img id="language-logo" width="48px" height="48px" alt="APL Logo" src="https://raw.githubusercontent.com/abrudz/logos/refs/heads/main/apl/green.svg"/>
      <div class="spaced-bar">
        <button class="material-symbols-outlined" title="Save Notebook" id="save">
          save
        </button>
        <button class="material-symbols-outlined" title="Download Notebook" id="save_file">
          file_save
        </button>
        <!-- <button class="material-symbols-outlined" title="New Notebook" id="new">
          note_add
        </button> -->
        <input type="file" id="fileInput" style="display: none;">
        <button class="material-symbols-outlined" title="Open Notebook from File" id="open">
          file_open
        </button>
        <button class="material-symbols-outlined" title="Open Saved Notebooks" id="open_from_account">
          book
        </button>
      </div>

      <fieldset class="spaced-bar">
        <input id="tool-pan" type="radio" name="tool" value="pan">
        <button for="tool-pan" title="Pan" class="material-symbols-outlined">
          drag_pan
        </button>
        <input id="tool-select" type="radio" name="tool" value="select" />
        <button for="tool-select" class="material-symbols-outlined">
          select
        </button>
        <input id="tool-write" type="radio" name="tool" value="write" checked/>
        <button for="tool-write" class="material-symbols-outlined">
          edit
        </button>
        <input id="tool-erase" type="radio" name="tool" value="erase">
        <button for="tool-erase" class="material-symbols-outlined">
          ink_eraser
        </button>
      </fieldset>

      <label>
        Pen Width
        <input id="pen-width" type="range" value="3" min="1" max="30"/>
      </label>
      <label>
        Eraser Width
        <input id="eraser-width" type="range" value="20" min="5" max="30"/>
      </label>

      <input id="line-color" type="color" value="#ffffff"/>

      <div class="spaced-bar">
        <button id="undo" title="Undo" class="material-symbols-outlined">undo</button>
        <button id="redo" title="Redo" class="material-symbols-outlined" disabled>redo</button>
      </div>

      <label>
        <input id="show-annotations" type="checkbox" checked/>
        Show Annotations
      </label>
      <fieldset class="spaced-bar">
        <input id="layer-code" type="radio" name="layer" value="code" checked/>
        <button for="layer-code">
          Code
        </button>
        <input id="layer-annotations" type="radio" name="layer" value="annotations"/>
        <button for="layer-annotations">
          Annotation
        </button>
      </fieldset>
      <div>
        <button id="open-settings">
          Settings
        </button>
      </div>
    </header>
    <main>
      <white-board id="whiteboard"
                   data-width="10000"
                   data-height="10000"
                   data-background="squares">
      </white-board>
    </main>
    <dialog id="settings-dialog">
      <h1>Settings</h1>
      <form method="dialog" class="close">
        <button class="material-symbols-outlined">close</button>
      </form>
      <fieldset>
        <legend>Touch Behaviour</legend>
        <input type="radio" id="touch-action-pan" name="touch-action" value="pan" checked/>
        <button for="touch-action-pan">
          Pan
        </button>
        <input type="radio" id="touch-action-auto" name="touch-action" value="auto"/>
        <button for="touch-action-auto">
          Auto (match pen and mouse)
        </button>
      </fieldset>
      <div>
        <label>Default Language</label>
        <select id="default-language" name="default-language">
          <option value="python3">Python</option>
          <option value="dyalog_apl">APL</option>
          <option value="lambda-calculus">Î» Calculus</option>
        </select>
      </div>
      <div>
        <label><input name="auto-execute" type="checkbox" value="on" checked/> Automatically execute new selections.</label>
      </div>
      <div>
        <label for="background-selection">Background</label>
        <select id="background-selection" name="background-selection">
          <option value="squares">Squares</option>
          <option value="none">None</option>
          <option value="lines">Lines</option>
          <option value="dots">Dots</option>
        </select>
      </div>
      <form action="{% url 'logout' %}" method="post">
        {% csrf_token %}
        <button type="submit">Log Out</button>
      </form>
    </dialog>
    <dialog id="notebooks-dialog">
      <h1>Notebooks</h1>
      <form method="dialog" class="close">
        <button class="material-symbols-outlined">close</button>
      </form>
      
      <div id="notebooks-container">
        {% for notebook in notebooks %}
          <div class="notebook-div" data-notebook-id="{{notebook.id}}">
            {{notebook.notebook_name}} --  {{notebook.notebook_created_at}} -- 
            <button class="open-notebook material-symbols-outlined" data-notebook-id="{{notebook.id}}" title="Open Notebook">draw</button>
            <button class="delete-notebook material-symbols-outlined" data-notebook-id="{{notebook.id}}" title="Delete Notebook">delete</button>
          </div>
        {% endfor %}
      </div>
      
    </dialog>
    <dialog id="save-notebook-dialog">
      <h1>Save Notebook</h1>
      <form method="dialog" class="close">
        <button class="material-symbols-outlined">close</button>
      </form>
      <label for="notebook-name-input">Notebook Name:</label>
      <input type="text" id="notebook-name-input" name="notebook-name-input">
      <button id="save-notebook-name">Save</button>
    </dialog>
    <div id="saved-popup">Saved</div>
    <script src="/static/main_app.js" type="module" charset="utf-8"></script>
  </body>
</html>
